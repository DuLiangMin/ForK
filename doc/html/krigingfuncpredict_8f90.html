<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ForK Library: krigingfuncpredict.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script src="../mathjax/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ForK Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<h1>krigingfuncpredict.f90 File Reference</h1>  </div>
</div>
<div class="contents">

<p>Subroutine to Predict mean function values from Kriging Surface (requires <a href="buildkriging_8f90.html">buildkriging</a> to be called first)  
<a href="#_details">More...</a></p>

<p><a href="krigingfuncpredict_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="krigingfuncpredict_8f90.html#a4ae47f5c71c479ec8d4777e87cc96fe1">krigingfuncpredict</a> (ndim, ntot, X, stot, H, beta, V, hyper, mtot, Xm, Hm, Ym, covarflagi)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Model predictions throughout the domain are determined by sampling from the conditional distribution \(y_* | \vec{X},Y\) using the covariance between points in the domain where \(\vec{X},Y\) are the input and output training data. The posterior mean predictions for an explicit mean are given by the formula: </p>
<p class="formulaDsp">
\[ y(\vec{x}_{*}) | \vec{X},Y,m(x) = m(\vec{x}_{*}) + k_*^T K^{-1} (Y-m(\vec{x}_{*})) \]
</p>
<p> where \(k_{*}^{T}\) represents the covariance between the test point, \(\vec{x}_{*}\), and the training points \(\vec{X}\) (a row vector of length ntot). <br/>
 For a regression mean function, the function predictions take the form of: </p>
<p class="formulaDsp">
\[ y(\vec{x}_{*}) | \vec{X},Y,\beta = h^{T}(\vec{x}_{*}) \beta + k_*^T K^{-1} (Y-H^{T} \beta) \]
</p>
<p> The regression parameters \(\beta\) and the hyperparamters in the covariance function are supplied by the subroutine <a href="buildkriging_8f90.html">buildkriging</a>. Using only this data, function predictions can be made; however, the construction and inverse of the covariance matrix can make the function predictions expensive. Because this matrix is inverted during the construction of the Kriging model, this work can be re-used for function predictions. Defining the processed data \(V\) as: </p>
<p class="formulaDsp">
\[ V = K^{-1} (Y - H^{T} \beta) \]
</p>
<p> the function predictions are given by: </p>
<p class="formulaDsp">
\[ y(\vec{x}_{*}) | \vec{X},Y,\beta = h^{T}(\vec{x}_{*}) \beta + k_*^T V \]
</p>
  <a href="#a4ae47f5c71c479ec8d4777e87cc96fe1"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Subroutine to Predict mean function values from Kriging Surface (requires <a href="buildkriging_8f90.html">buildkriging</a> to be called first) </p>

<p>Definition in file <a class="el" href="krigingfuncpredict_8f90_source.html">krigingfuncpredict.f90</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a4ae47f5c71c479ec8d4777e87cc96fe1"></a><!-- doxytag: member="krigingfuncpredict.f90::krigingfuncpredict" ref="a4ae47f5c71c479ec8d4777e87cc96fe1" args="(ndim, ntot, X, stot, H, beta, V, hyper, mtot, Xm, Hm, Ym, covarflagi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine krigingfuncpredict </td>
          <td>(</td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>ntot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(ndim,ntot),intent(in)&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>stot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(stot,ntot),intent(in)&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(stot),intent(in)&#160;</td>
          <td class="paramname"><em>Beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(ntot),intent(in)&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(ndim+2),intent(in)&#160;</td>
          <td class="paramname"><em>hyper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>mtot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(ndim,mtot),intent(in)&#160;</td>
          <td class="paramname"><em>Xm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(stot,mtot),intent(in)&#160;</td>
          <td class="paramname"><em>Hm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(mtot),intent(out)&#160;</td>
          <td class="paramname"><em>Ym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>covarflagi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Model predictions throughout the domain are determined by sampling from the conditional distribution \(y_* | \vec{X},Y\) using the covariance between points in the domain where \(\vec{X},Y\) are the input and output training data. The posterior mean predictions for an explicit mean are given by the formula: </p>
<p class="formulaDsp">
\[ y(\vec{x}_{*}) | \vec{X},Y,m(x) = m(\vec{x}_{*}) + k_*^T K^{-1} (Y-m(\vec{x}_{*})) \]
</p>
<p> where \(k_{*}^{T}\) represents the covariance between the test point, \(\vec{x}_{*}\), and the training points \(\vec{X}\) (a row vector of length ntot). <br/>
 For a regression mean function, the function predictions take the form of: </p>
<p class="formulaDsp">
\[ y(\vec{x}_{*}) | \vec{X},Y,\beta = h^{T}(\vec{x}_{*}) \beta + k_*^T K^{-1} (Y-H^{T} \beta) \]
</p>
<p> The regression parameters \(\beta\) and the hyperparamters in the covariance function are supplied by the subroutine <a href="buildkriging_8f90.html">buildkriging</a>. Using only this data, function predictions can be made; however, the construction and inverse of the covariance matrix can make the function predictions expensive. Because this matrix is inverted during the construction of the Kriging model, this work can be re-used for function predictions. Defining the processed data \(V\) as: </p>
<p class="formulaDsp">
\[ V = K^{-1} (Y - H^{T} \beta) \]
</p>
<p> the function predictions are given by: </p>
<p class="formulaDsp">
\[ y(\vec{x}_{*}) | \vec{X},Y,\beta = h^{T}(\vec{x}_{*}) \beta + k_*^T V \]
</p>
 </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Brian Lockwood <br/>
 Department of Mechanical Engineering <br/>
 University of Wyoming </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>May 2, 2012 </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">in)</td><td><b>ndim </b>: The dimension of the problem </td></tr>
    <tr><td class="paramname">in)</td><td><b>ntot </b>: The number of Training points </td></tr>
    <tr><td class="paramname">in)</td><td><b>X </b>: The location of the training points (size=[ndimxntot]) </td></tr>
    <tr><td class="paramname">in)</td><td><b>stot </b>: Number of Terms in the regression </td></tr>
    <tr><td class="paramname">in)</td><td><b>H</b>: The collocation matrix for the regression (size=[stotxntot]) </td></tr>
    <tr><td class="paramname">in)</td><td><b> beta</b>: Regression coefficients based on the optimal estimate for the Kriging model (size=[stot]) <br/>
 Supplied by <a href="buildkriging_8f90.html">buildkriging</a> subroutine </td></tr>
    <tr><td class="paramname">in)</td><td><b>V</b>: Processed Training Data (size=[ntot]) <br/>
 Supplied by <a href="buildkriging_8f90.html">buildkriging</a> subroutine </td></tr>
    <tr><td class="paramname">in)</td><td><b>hyper</b>: Hyperparameters for the Kriging Model (size=[ndim+2]) <br/>
 Supplied by <a href="buildkriging_8f90.html">buildkriging</a> subroutine </td></tr>
    <tr><td class="paramname">in)</td><td><b>mtot </b>: The number of test points, the places where function prediction are desired </td></tr>
    <tr><td class="paramname">in)</td><td><b>Xm </b>: The location of the test points (size=[ndimxmtot]) </td></tr>
    <tr><td class="paramname">in)</td><td><b>Hm </b>: The collocation matrix evaluated at the test points (size=[stotxmtot]) </td></tr>
    <tr><td class="paramname">out)</td><td><b>Ym</b>: The predicted function values (size=[mtot]) <br/>
 Using the processed data V, predicting function values is essentially linear with respect to the number of test points so mtot can be set to one and this subroutine can be called multiple times. <br/>
 Often the function values at a set of test points is required, hence the ability to make the predictions in a single function call. </td></tr>
    <tr><td class="paramname">in)</td><td><b>covarflagi</b>: Flag to govern which covariance function is used <br/>
 </p>
<ul>
<li>
covarflag==0 Uses Matern function with \(\nu=1/2\) </li>
<li>
covarflag==1 Uses Matern function with \(\nu=3/2\) </li>
<li>
covarflag==2 Uses Matern function with \(\nu=5/2\) </li>
</ul>
<p><br/>
 The parameter \(\nu\) governs the smoothness and differentiability of the covariance function. For function only Kriging, all three options are available. <br/>
 Must supply the same covariance flag as used in <a href="buildkriging_8f90.html">buildkriging</a>. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="krigingfuncpredict_8f90_source.html#l00052">52</a> of file <a class="el" href="krigingfuncpredict_8f90_source.html">krigingfuncpredict.f90</a>.</p>

<p>References <a class="el" href="covars_8f90_source.html#l00014">covars::covarflag</a>.</p>

<p>Referenced by <a class="el" href="funcmod_8f90_source.html#l00084">funcmod::func_kriging()</a>, and <a class="el" href="krigingwrapper_8f90_source.html#l00012">krigingwrapper()</a>.</p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>
Copyright (C) 2012 Brian A. Lockwood <br>
Generated on Tue May 1 2012 17:15:55 for Kriging Library
by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer"
							 src="doxygen.png"
							 alt="doxygen"/></a>
1.7.3
</small></address>
