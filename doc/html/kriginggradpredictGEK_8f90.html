<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ForK Library: kriginggradpredictGEK.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script src="../mathjax/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ForK Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<h1>kriginggradpredictGEK.f90 File Reference</h1>  </div>
</div>
<div class="contents">

<p>Subroutine to predict mean derivative values from Gradient-Enhanced Kriging Surface (requires <a href="buildkrigingGEK_8f90.html">buildkrigingGEK</a> to be called first)  
<a href="#_details">More...</a></p>

<p><a href="kriginggradpredictGEK_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="kriginggradpredictGEK_8f90.html#ad62ae3926ed5e30bb499654de60f9867">kriginggradpredictGEK</a> (ndim, ntot, X, gtot, pts, dims, stot, H, beta, V, hyper, mtot, Xm, gtotm, ptsm, dimsm, Gm, dYm, covarflagi)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Predicting derivative values from a gradient-enhanced Kriging model follows the same procedure as predicting derivative values from function-only Kriging models (see <a href="kriginggradpredict_8f90.html">kriginggradpredict</a> for details). For a gradient-enhanced model, derivative values are predicted as:  <a href="#ad62ae3926ed5e30bb499654de60f9867"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Subroutine to predict mean derivative values from Gradient-Enhanced Kriging Surface (requires <a href="buildkrigingGEK_8f90.html">buildkrigingGEK</a> to be called first) </p>

<p>Definition in file <a class="el" href="kriginggradpredictGEK_8f90_source.html">kriginggradpredictGEK.f90</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="ad62ae3926ed5e30bb499654de60f9867"></a><!-- doxytag: member="kriginggradpredictGEK.f90::kriginggradpredictGEK" ref="ad62ae3926ed5e30bb499654de60f9867" args="(ndim, ntot, X, gtot, pts, dims, stot, H, beta, V, hyper, mtot, Xm, gtotm, ptsm, dimsm, Gm, dYm, covarflagi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kriginggradpredictGEK </td>
          <td>(</td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>ntot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(ndim,ntot),intent(in)&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>gtot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,dimension(gtot),intent(in)&#160;</td>
          <td class="paramname"><em>pts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,dimension(gtot),intent(in)&#160;</td>
          <td class="paramname"><em>dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>stot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(stot,ntot+gtot),intent(in)&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(stot),intent(in)&#160;</td>
          <td class="paramname"><em>Beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(ntot+gtot),intent(in)&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(ndim+3),intent(in)&#160;</td>
          <td class="paramname"><em>hyper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>mtot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(ndim,mtot),intent(in)&#160;</td>
          <td class="paramname"><em>Xm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>gtotm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,dimension(gtotm),intent(in)&#160;</td>
          <td class="paramname"><em>ptsm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,dimension(gtotm),intent(in)&#160;</td>
          <td class="paramname"><em>dimsm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(stot,gtotm),intent(in)&#160;</td>
          <td class="paramname"><em>Gm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(gtotm),intent(out)&#160;</td>
          <td class="paramname"><em>dYm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>covarflagi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Predicting derivative values from a gradient-enhanced Kriging model follows the same procedure as predicting derivative values from function-only Kriging models (see <a href="kriginggradpredict_8f90.html">kriginggradpredict</a> for details). For a gradient-enhanced model, derivative values are predicted as: </p>
<p class="formulaDsp">
\[ \frac{\partial y(\vec{x}_{*})}{\partial x_{k}} = g_{k}(\vec{x}_{*}) \beta + \underline{l}_{*,k}^{T} \underline{K}^{-1} (\underline{Y} - \underline{H}^{T} \beta) \]
</p>
<p> where the underline denotes the block definition required to account for derivative values. The block definitions of the training data, collocation matrix and covariance matrix are given in the documentation of <a href="buildkrigingGEK_8f90.html">buildkrigingGEK</a>. The matrix \( \underline{l}_{*,k}^{T} \) is a block matrix whose elements represent covariance between derivative values and function values as well as derivative values with other derivative values: where the elements of \(cov( \frac{\partial y^{*}}{\partial x_{k}}, Y)\) are given by: </p>
<p class="formulaDsp">
\[ cov(\frac{\partial y^{*}}{\partial x_{k}}, Y_{j}) = \frac{\partial}{\partial x_{k}} k(\vec{x}_{*},X_{j}) \]
</p>
<p> and the elements of \(cov(\frac{\partial y^{*}}{\partial x_{k}}, \delta Y)\) are given as: </p>
<p class="formulaDsp">
\[ cov(\frac{\partial y^{*}}{\partial x_{k}}, \delta Y_{j,l}) = \frac{\partial^{2}}{\partial x_{k} \partial x_{l}} k(\vec{x}_{*},X_{j}) \]
</p>
<p> Using the processed data produced by <a href="buildkrigingGEK_8f90.html">buildkrigingGEK</a>, derivative values can be calculated as: </p>
<p class="formulaDsp">
\[ \frac{\partial y(\vec{x}_{*})}{\partial x_{k}} = g_{k}(\vec{x}_{*}) \beta + \underline{l}_{*,k}^{T} \underline{V} \]
</p>
 <dl class="author"><dt><b>Author:</b></dt><dd>Brian Lockwood Department of Mechanical Engineering University of Wyoming </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>May 2, 2012 </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">in)</td><td><b>ndim </b>: The dimension of the problem </td></tr>
    <tr><td class="paramname">in)</td><td><b>ntot </b>: The number of Training points </td></tr>
    <tr><td class="paramname">in)</td><td><b>X </b>: The location of the training points (size=[ndimxntot]) </td></tr>
    <tr><td class="paramname">in)</td><td><b>gtot</b>: Number of derivative values included in training data (ndim*ntot if all derivatives are included at the training points) </td></tr>
    <tr><td class="paramname">in)</td><td><b>pts</b>: List identifying what point the derivative value is enforced at (size=[gtot] with values ranging from 1 to ntot) </td></tr>
    <tr><td class="paramname">in)</td><td><b>dims</b>: List identifying the dimension the derivative is taken with respect to (size=[gtot] with values ranging from 1 to ndim) </td></tr>
    <tr><td class="paramname">in)</td><td><b>stot </b>: Number of Terms in the regression </td></tr>
    <tr><td class="paramname">in)</td><td><b>H</b>: The collocation matrix for the regression including derivative values. (size=[stotxntot+gtot]) <br/>
 Columns 1:ntot are the basis evaluated at the training points <br/>
 Columns ntot+1:ntot+gtot are the derivative of the basis evaluated at the training points </td></tr>
    <tr><td class="paramname">in)</td><td><b> beta</b>: Regression coefficients based on the optimal estimate for the Kriging model (size=[stot]) <br/>
 Supplied by <a href="buildkrigingGEK_8f90.html">buildkrigingGEK</a> subroutine </td></tr>
    <tr><td class="paramname">in)</td><td><b>V</b>: Processed Training Data (size=[ntot+gtot]) <br/>
 Supplied by <a href="buildkrigingGEK_8f90.html">buildkrigingGEK</a> subroutine </td></tr>
    <tr><td class="paramname">in)</td><td><b>hyper</b>: Hyperparameters for the Kriging Model (size=[ndim+3]) <br/>
 Supplied by <a href="buildkrigingGEK_8f90.html">buildkrigingGEK</a> subroutine </td></tr>
    <tr><td class="paramname">in)</td><td><b>mtot </b>: The number of test points, the places where function prediction are desired </td></tr>
    <tr><td class="paramname">in)</td><td><b>Xm </b>: The location of the test points (size=[ndimxmtot]) </td></tr>
    <tr><td class="paramname">in)</td><td><b>gtotm</b>: The total number of derivatives to be predicted (ndim*mtot if the gradient at every test point is desired) </td></tr>
    <tr><td class="paramname">in)</td><td><b> ptsm</b>: A vector identifying the test point where a particular derivative is specified (size=[gtotm] with values ranging from 1 to mtot) </td></tr>
    <tr><td class="paramname">in)</td><td><b> dimsm</b>: A vector identifying the dimension the derivative is taken with respect to (size=[gtotm] with values ranging from 1 to ndim) </td></tr>
    <tr><td class="paramname">in)</td><td><b>Gm </b>: The derivative of the regression basis evaluated at the test points (size=[stotxgtotm]) </td></tr>
    <tr><td class="paramname">out)</td><td><b>dYm</b>: The predicted function values (size=[gtotm]) <br/>
 Using the processed data V, predicting derivative values is essentially linear with respect to the number of test points so mtot can be set to one and this subroutine can be called multiple times if desired. <br/>
 </td></tr>
    <tr><td class="paramname">in)</td><td><b>covarflagi</b>: Flag to govern which covariance function is used <br/>
 </p>
<ul>
<li>
covarflag==1 Uses Matern function with \(\nu=3/2\) </li>
<li>
covarflag==2 Uses Matern function with \(\nu=5/2\) </li>
</ul>
<p><br/>
 The parameter \(\nu\) governs the smoothness and differentiability of the covariance function. <br/>
 When using gradient values, \(\nu=1/2\) is not differentiable enough so \(\nu \geq 3/2\) must be used<br/>
 Must supply the same covariance flag as used in <a href="buildkrigingGEK_8f90.html">buildkrigingGEK</a>. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="kriginggradpredictGEK_8f90_source.html#l00069">69</a> of file <a class="el" href="kriginggradpredictGEK_8f90_source.html">kriginggradpredictGEK.f90</a>.</p>

<p>References <a class="el" href="covars_8f90_source.html#l00014">covars::covarflag</a>.</p>

<p>Referenced by <a class="el" href="krigingwrapperGEK_8f90_source.html#l00012">krigingwrapper()</a>.</p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>
Copyright (C) 2012 Brian A. Lockwood <br>
Generated on Tue May 1 2012 17:15:55 for Kriging Library
by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer"
							 src="doxygen.png"
							 alt="doxygen"/></a>
1.7.3
</small></address>
