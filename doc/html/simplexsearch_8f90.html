<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ForK Library: simplexsearch.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script src="../mathjax/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ForK Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<h1>simplexsearch.f90 File Reference</h1>  </div>
</div>
<div class="contents">

<p>Simplex Search used for optimization <br/>
 Used for max likelihood optimization and determining min/max values from Kriging surface <br/>
 Suitable for fast local optimization using function values.  
<a href="#_details">More...</a></p>

<p><a href="simplexsearch_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="simplexsearch_8f90.html#adc5da004101ec7585c303f8bba1bd4da">simplexsearch</a> (odim, Xl, Xf, Fmin, L, U, flag, args)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine implements the <a href="http://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method">Nelder-Mead method</a> for optimization applied to the max likelihood problem and optimization performed on the Kriging surface itself. <br/>
 <br/>
 For this method, a simplex element in \(N\) dimensions (set by the argument <em>odim</em>) is constructed and the search direction for new function values is constructed based on the vertices and faces of this element. The procedure for determining the minimum value is outlined below. For maximization, all function values can be multiplied by \(-1\) and the minimization algorithm can be applied.  <a href="#adc5da004101ec7585c303f8bba1bd4da"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Simplex Search used for optimization <br/>
 Used for max likelihood optimization and determining min/max values from Kriging surface <br/>
 Suitable for fast local optimization using function values. </p>

<p>Definition in file <a class="el" href="simplexsearch_8f90_source.html">simplexsearch.f90</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="adc5da004101ec7585c303f8bba1bd4da"></a><!-- doxytag: member="simplexsearch.f90::simplexsearch" ref="adc5da004101ec7585c303f8bba1bd4da" args="(odim, Xl, Xf, Fmin, L, U, flag, args)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine simplexsearch </td>
          <td>(</td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>odim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(odim),intent(in)&#160;</td>
          <td class="paramname"><em>Xl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(odim),intent(out)&#160;</td>
          <td class="paramname"><em>Xf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),intent(out)&#160;</td>
          <td class="paramname"><em>Fmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(odim),intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(odim),intent(in)&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="typeargument_1_1generalarg.html">generalarg</a>)&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This subroutine implements the <a href="http://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method">Nelder-Mead method</a> for optimization applied to the max likelihood problem and optimization performed on the Kriging surface itself. <br/>
 <br/>
 For this method, a simplex element in \(N\) dimensions (set by the argument <em>odim</em>) is constructed and the search direction for new function values is constructed based on the vertices and faces of this element. The procedure for determining the minimum value is outlined below. For maximization, all function values can be multiplied by \(-1\) and the minimization algorithm can be applied. </p>
<ul>
<li>
Starting with \(N + 1\) function evaluations, the maximum function value in the element is determined ( \(F_{max}\)) </li>
<li>
The search direction is given by the vector between the maximum function value of the element and the centroid of the remaining vertices. <br/>
 <p class="formulaDsp">
\[\vec{p} = \vec{X}_{face} - \vec{X}_{max}\]
</p>
 where <p class="formulaDsp">
\[\vec{X}_{face} =\frac{1}{N} \sum_{i \ne max} \vec{X}_{i}\]
</p>
 </li>
<li>
A line search is next performed in this direction to determine the new candidate point. The following points are tested. <ol>
<li>
Reflected point: \(\vec{X}_{r} = \vec{X}_{face} + \vec{p} \) </li>
<li>
Expanded point: \(\vec{X}_{e} = \vec{X}_{face} + 2 \vec{p} \) </li>
<li>
Outside Contraction: \(\vec{X}_{oc} = \vec{X}_{face} + \frac{1}{2} \vec{p} \) </li>
<li>
Inside Contraction: \(\vec{X}_{ic} = \vec{X}_{face} - \frac{1}{2} \vec{p} \)</li>
</ol>
If the reflected point's function value is the new minimum value, the expanded point is tested. <br/>
 If the reflected point's function value is less than the previous maximum value in the element but would still correspond to the maximum vertex value in the element, outside contraction is performed. <br/>
 If the reflected point's function value is greater than the previous maximum value, inside contraction is performed. <br/>
 </li>
<li>
Based on the results of the line search, the previous maximum vertex value is replaced by the best candidate determined in the line search (either the reflected point, expanded point, outside contraction or inside contraction). </li>
<li>
In the event that none of the candidate locations tested in the line search are able to reduce the maximum function value of the element, a rescaling is performed around the minimum location. <p class="formulaDsp">
\[ \vec{X}&#39;_{i} = \vec{X}_{min} + \frac{1}{2} (\vec{X}_{i} - \vec{X}_{min}) \]
</p>
 </li>
</ul>
<p><br/>
 <br/>
 More details of this algorithm can be found in <em>Numerical Optimization</em> by Nocedal and Wright </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Brian Lockwood <br/>
 Department of Mechanical Engineering <br/>
 University of Wyoming </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>May 15, 2012 </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">in)</td><td><b> odim </b>: Dimension of the optimization </td></tr>
    <tr><td class="paramname">in)</td><td><b> Xl </b>: Starting point for the optimization </td></tr>
    <tr><td class="paramname">out)</td><td><b> Xf </b>: Final optimal location </td></tr>
    <tr><td class="paramname">out)</td><td><b> Fmin </b>: Final optimal value </td></tr>
    <tr><td class="paramname">in)</td><td><b> L </b>: Lower bound for each variable </td></tr>
    <tr><td class="paramname">in)</td><td><b> U </b>: Upper bound for each variable </td></tr>
    <tr><td class="paramname">in)</td><td><b> flag </b>: Determines whether minimum or maximum value is found <br/>
 </p>
<ul>
<li>
flag = 0 Subroutine finds the minimum value </li>
<li>
flag = 1 Subroutine finds the maximum value</li>
</ul>
</td></tr>
    <tr><td class="paramname">in)</td><td><b> args </b>: Structure containing additional arguments required for the function call <br/>
 These structures are in the module <a href="argument_8f90.html">argument </a> <br/>
 The structures for each function type are housed within the structure "generalarg" and the subroutine <a href="funcwrapper_8f90.html">funcwrapper</a> detects the function type and selects the proper element of "generalarg" </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="simplexsearch_8f90_source.html#l00052">52</a> of file <a class="el" href="simplexsearch_8f90_source.html">simplexsearch.f90</a>.</p>

<p>References <a class="el" href="funcwrapper_8f90_source.html#l00013">funcwrapper()</a>.</p>

<p>Referenced by <a class="el" href="hyperparameters__all_8f90_source.html#l00019">hyperparameters_all_mod::hyperparameters_all_func()</a>, <a class="el" href="hyperparameters__all_8f90_source.html#l00086">hyperparameters_all_mod::hyperparameters_all_grad()</a>, <a class="el" href="hyperparameters__mle_8f90_source.html#l00019">hyperparameters_mle_mod::hyperparameters_mle_func()</a>, <a class="el" href="hyperparameters__mle_8f90_source.html#l00074">hyperparameters_mle_mod::hyperparameters_mle_grad()</a>, <a class="el" href="krigingextremefuncpredict_8f90_source.html#l00057">krigingextremefuncpredict()</a>, <a class="el" href="krigingextremefuncpredictGEK_8f90_source.html#l00061">krigingextremefuncpredictGEK()</a>, <a class="el" href="krigingmaxeipredict_8f90_source.html#l00065">krigingmaxeipredict()</a>, <a class="el" href="krigingmaxeipredictGEK_8f90_source.html#l00062">krigingmaxeipredictGEK()</a>, <a class="el" href="krigingmaxvariancepredict_8f90_source.html#l00055">krigingmaxvariancepredict()</a>, and <a class="el" href="krigingmaxvariancepredictGEK_8f90_source.html#l00057">krigingmaxvariancepredictGEK()</a>.</p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>
Copyright (C) 2012 Brian A. Lockwood <br>
Generated on Tue May 1 2012 17:15:55 for Kriging Library
by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer"
							 src="doxygen.png"
							 alt="doxygen"/></a>
1.7.3
</small></address>
