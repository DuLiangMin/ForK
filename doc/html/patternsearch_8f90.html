<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ForK Library: patternsearch.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script src="../mathjax/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ForK Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<h1>patternsearch.f90 File Reference</h1>  </div>
</div>
<div class="contents">

<p>Pattern Search used for global optimization <br/>
 Used for max likelihood optimization and determining min/max values from Kriging surface.  
<a href="#_details">More...</a></p>

<p><a href="patternsearch_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="patternsearch_8f90.html#af6580ac7089f47d7ccc7d8b835fd6f85">patternsearch</a> (odim, Xl, Xf, Fmin, L, U, flag, args)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The pattern search is a function-only optimization method suitable for global optimization problems. Given an initial function evaluation, the pattern search performs additional function evaluations in a set of fixed search directions about this initial point (with the same step size in each direction). <br/>
<br/>
 If one of the new function values is less than the initial function value, the center of the stencil is shifted to the new minimum value and the process is repeated about this new minimum point. <br/>
<br/>
 If none of the new function evaluations are less than the initial value, the center of the stencil is unchanged and additional function evaluations are performed using half the step size. The process is repeated until the step size is sufficiently small or the relative change in the function value is below a specified tolerance.<br/>
<br/>
  <a href="#af6580ac7089f47d7ccc7d8b835fd6f85"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Pattern Search used for global optimization <br/>
 Used for max likelihood optimization and determining min/max values from Kriging surface. </p>

<p>Definition in file <a class="el" href="patternsearch_8f90_source.html">patternsearch.f90</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="af6580ac7089f47d7ccc7d8b835fd6f85"></a><!-- doxytag: member="patternsearch.f90::patternsearch" ref="af6580ac7089f47d7ccc7d8b835fd6f85" args="(odim, Xl, Xf, Fmin, L, U, flag, args)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine patternsearch </td>
          <td>(</td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>odim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(odim),intent(in)&#160;</td>
          <td class="paramname"><em>Xl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(odim),intent(out)&#160;</td>
          <td class="paramname"><em>Xf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),intent(out)&#160;</td>
          <td class="paramname"><em>Fmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(odim),intent(in)&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(odim),intent(in)&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="typeargument_1_1generalarg.html">generalarg</a>)&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The pattern search is a function-only optimization method suitable for global optimization problems. Given an initial function evaluation, the pattern search performs additional function evaluations in a set of fixed search directions about this initial point (with the same step size in each direction). <br/>
<br/>
 If one of the new function values is less than the initial function value, the center of the stencil is shifted to the new minimum value and the process is repeated about this new minimum point. <br/>
<br/>
 If none of the new function evaluations are less than the initial value, the center of the stencil is unchanged and additional function evaluations are performed using half the step size. The process is repeated until the step size is sufficiently small or the relative change in the function value is below a specified tolerance.<br/>
<br/>
 </p>
<p>The directions used in this pattern search are the positive and negative coordinate directions of the design space. This choice leads to \(2N\) total search directions (and consequently \(2N\) function evaluations per iteration). <br/>
<br/>
 For more details, refer to <a href="http://en.wikipedia.org/wiki/Pattern_search_(optimization)">Pattern_search_(optimization)</a>. <br/>
 <br/>
 This subroutine has shared memory parallelization using <a href="http://openmp.org/wp/">openmp</a>. Because each step in the optimization requires \(2N\) independent function evaluations, these evaluations can be performed simultaneously on different threads. Although this parallelization is efficient from a scaling point of view, each thread requires a large memory footprint. In the case of likelihood evaluations (this also applies for some of the Kriging subroutines), each thread must compute and store the covariance matrix, requiring a large amount of stack memory. Hence, the environmental variable "OMP_STACKSIZE" must be set to a suitably large value to avoid a segmentation fault. A good rule of thumb is to base the STACKSIZE on the size of the covariance matrix. This matrix is \(NxN\) for a function only Kriging model and \(N(D+1)xN(D+1)\) for a gradient-enhanced model (where \(N\) is the number of training points and \(D\) is the dimension of the problem). The elements of this matrix are double precision real numbers and thus require \(8\) bytes of storage for each element. Using these rules, a suitable STACKSIZE can be set. In some cases, the desired number of threads must be reduced to allow for the larger STACKSIZE for each thread to fit in main memory. Because the optimization is the most expensive part of the Kriging construction, determining the proper STACKSIZE and using the maximum number of threads is well worth the possible aggrevation. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Brian Lockwood <br/>
 Department of Mechanical Engineering <br/>
 University of Wyoming </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>May 15, 2012 </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">in)</td><td><b> odim </b>: Dimension of the optimization </td></tr>
    <tr><td class="paramname">in)</td><td><b> Xl </b>: Starting point for the optimization </td></tr>
    <tr><td class="paramname">out)</td><td><b> Xf </b>: Final optimal location </td></tr>
    <tr><td class="paramname">out)</td><td><b> Fmin </b>: Final optimal value </td></tr>
    <tr><td class="paramname">in)</td><td><b> L </b>: Lower bound for each variable </td></tr>
    <tr><td class="paramname">in)</td><td><b> U </b>: Upper bound for each variable </td></tr>
    <tr><td class="paramname">in)</td><td><b> flag </b>: Determines whether minimum or maximum value is found <br/>
 </p>
<ul>
<li>
flag = 0 Subroutine finds the minimum value </li>
<li>
flag = 1 Subroutine finds the maximum value</li>
</ul>
</td></tr>
    <tr><td class="paramname">in)</td><td><b> args </b>: Structure containing additional arguments required for the function call <br/>
 These structures are in the module <a href="argument_8f90.html">argument </a> <br/>
 The structures for each function type are housed within the structure "generalarg" and the subroutine <a href="funcwrapper_8f90.html">funcwrapper</a> detects the function type and selects the proper element of "generalarg" </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="patternsearch_8f90_source.html#l00040">40</a> of file <a class="el" href="patternsearch_8f90_source.html">patternsearch.f90</a>.</p>

<p>References <a class="el" href="opt_8f90_source.html#l00038">opt::contractionfunc()</a>, <a class="el" href="opt_8f90_source.html#l00028">opt::expansionfunc()</a>, <a class="el" href="opt_8f90_source.html#l00017">opt::forcingfunc()</a>, and <a class="el" href="funcwrapper_8f90_source.html#l00013">funcwrapper()</a>.</p>

<p>Referenced by <a class="el" href="hyperparameters__all_8f90_source.html#l00019">hyperparameters_all_mod::hyperparameters_all_func()</a>, <a class="el" href="hyperparameters__all_8f90_source.html#l00086">hyperparameters_all_mod::hyperparameters_all_grad()</a>, <a class="el" href="hyperparameters__mle_8f90_source.html#l00019">hyperparameters_mle_mod::hyperparameters_mle_func()</a>, <a class="el" href="hyperparameters__mle_8f90_source.html#l00074">hyperparameters_mle_mod::hyperparameters_mle_grad()</a>, <a class="el" href="krigingextremefuncpredict_8f90_source.html#l00057">krigingextremefuncpredict()</a>, <a class="el" href="krigingextremefuncpredictGEK_8f90_source.html#l00061">krigingextremefuncpredictGEK()</a>, <a class="el" href="krigingmaxeipredict_8f90_source.html#l00065">krigingmaxeipredict()</a>, <a class="el" href="krigingmaxeipredictGEK_8f90_source.html#l00062">krigingmaxeipredictGEK()</a>, <a class="el" href="krigingmaxvariancepredict_8f90_source.html#l00055">krigingmaxvariancepredict()</a>, and <a class="el" href="krigingmaxvariancepredictGEK_8f90_source.html#l00057">krigingmaxvariancepredictGEK()</a>.</p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>
Copyright (C) 2012 Brian A. Lockwood <br>
Generated on Tue May 1 2012 17:15:55 for Kriging Library
by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer"
							 src="doxygen.png"
							 alt="doxygen"/></a>
1.7.3
</small></address>
