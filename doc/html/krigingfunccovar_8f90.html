<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ForK Library: krigingfunccovar.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script src="../mathjax/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ForK Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<h1>krigingfunccovar.f90 File Reference</h1>  </div>
</div>
<div class="contents">

<p>This subroutine calculates the covariance matrix associated with the Kriging model's output distribution. This matrix is useful when the quantifying the uncertainty of general code predictions (such as a quantile prediction or statistic prediction). This subroutine is order \(M^{2}\) in complexity, where \(M\) is the number of test points. It is very slow, so use with caution.  
<a href="#_details">More...</a></p>

<p><a href="krigingfunccovar_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="krigingfunccovar_8f90.html#a9008d9b66ad44fabd9c35028f5e042c6">krigingfunccovar</a> (ndim, ntot, X, stot, H, hyper, mtot, Xm, Hm, S, covarflagi)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The covariance matrix for the Kriging output distribution can be useful when predicting the uncertainty (or confidence) in general predictions based on the Kriging surface. Although the variance can be used for quantifiying the uncertainty associated with point predictions, the uncertainty associated with global predictions such as moment statistics or quantiles requires sampling from the Kriging output distribution and computing multiple estimates of this global prediction. A distribution can then be constructed for these predictions, allowing a confidence interval to be associated with the predictions from the Kriging model. <br/>
  <a href="#a9008d9b66ad44fabd9c35028f5e042c6"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This subroutine calculates the covariance matrix associated with the Kriging model's output distribution. This matrix is useful when the quantifying the uncertainty of general code predictions (such as a quantile prediction or statistic prediction). This subroutine is order \(M^{2}\) in complexity, where \(M\) is the number of test points. It is very slow, so use with caution. </p>

<p>Definition in file <a class="el" href="krigingfunccovar_8f90_source.html">krigingfunccovar.f90</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a9008d9b66ad44fabd9c35028f5e042c6"></a><!-- doxytag: member="krigingfunccovar.f90::krigingfunccovar" ref="a9008d9b66ad44fabd9c35028f5e042c6" args="(ndim, ntot, X, stot, H, hyper, mtot, Xm, Hm, S, covarflagi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine krigingfunccovar </td>
          <td>(</td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>ntot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(ndim,ntot),intent(in)&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>stot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(stot,ntot),intent(in)&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(ndim+2),intent(in)&#160;</td>
          <td class="paramname"><em>hyper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>mtot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(ndim,mtot),intent(in)&#160;</td>
          <td class="paramname"><em>Xm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(stot,mtot),intent(in)&#160;</td>
          <td class="paramname"><em>Hm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8),dimension(mtot,mtot),intent(out)&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&#160;</td>
          <td class="paramname"><em>covarflagi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The covariance matrix for the Kriging output distribution can be useful when predicting the uncertainty (or confidence) in general predictions based on the Kriging surface. Although the variance can be used for quantifiying the uncertainty associated with point predictions, the uncertainty associated with global predictions such as moment statistics or quantiles requires sampling from the Kriging output distribution and computing multiple estimates of this global prediction. A distribution can then be constructed for these predictions, allowing a confidence interval to be associated with the predictions from the Kriging model. <br/>
 </p>
<p>To sample from the Kriging model's output distribution, the output covariance matrix is constructed (<em>S</em> in this code) and Cholesky is performed (the result of which is denoted as \(L\)). Samples from the output distribution are given as: </p>
<p class="formulaDsp">
\[ Y_{p} = Y_{m} + L u\]
</p>
<p> where \(Y_{m}\) is the mean of the Kriging function's output (the result of <a href="krigingfuncpredict_8f90.html">krigingfuncpredict</a>) and \(u\) is a vector of normally distributioned values of length \(M\) (normal distribution with zero mean and standard deviation of 1). The sampling itself is performed in the subroutine <a href="krigingfuncsample_8f90.html">krigingfuncsample</a> but it requires the covariance matrix to be constructed and cholesky performed. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Brian Lockwood <br/>
 Department of Mechanical Engineering <br/>
 University of Wyoming </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>May 18, 2012 </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">in)</td><td><b>ndim </b>: The dimension of the problem </td></tr>
    <tr><td class="paramname">in)</td><td><b>ntot </b>: The number of Training points </td></tr>
    <tr><td class="paramname">in)</td><td><b>X </b>: The location of the training points (size=[ndimxntot]) </td></tr>
    <tr><td class="paramname">in)</td><td><b>stot </b>: Number of Terms in the regression </td></tr>
    <tr><td class="paramname">in)</td><td><b>H</b>: The collocation matrix for the regression (size=[stotxntot]) </td></tr>
    <tr><td class="paramname">in)</td><td><b>hyper</b>: Hyperparameters for the Kriging Model (size=[ndim+2]) <br/>
 Supplied by <a href="buildkriging_8f90.html">buildkriging</a> subroutine </td></tr>
    <tr><td class="paramname">in)</td><td><b>mtot </b>: The number of test points, the places where function prediction are desired </td></tr>
    <tr><td class="paramname">in)</td><td><b>Xm </b>: The location of the test points (size=[ndimxmtot]) </td></tr>
    <tr><td class="paramname">in)</td><td><b>Hm </b>: The collocation matrix evaluated at the test points (size=[stotxmtot]) </td></tr>
    <tr><td class="paramname">out)</td><td><b>S</b>: Covariance matrix between function values (size=[mtotxmtot]) <br/>
 </td></tr>
    <tr><td class="paramname">in)</td><td><b>covarflagi</b>: Flag to govern which covariance function is used <br/>
 </p>
<ul>
<li>
covarflag==0 Uses Matern function with \(\nu=1/2\) </li>
<li>
covarflag==1 Uses Matern function with \(\nu=3/2\) </li>
<li>
covarflag==2 Uses Matern function with \(\nu=5/2\) </li>
</ul>
<p><br/>
 The parameter \(\nu\) governs the smoothness and differentiability of the covariance function. For function only Kriging, all three options are available. <br/>
 Must supply the same covariance flag as used in <a href="buildkriging_8f90.html">buildkriging</a>. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="krigingfunccovar_8f90_source.html#l00040">40</a> of file <a class="el" href="krigingfunccovar_8f90_source.html">krigingfunccovar.f90</a>.</p>

<p>References <a class="el" href="covars_8f90_source.html#l00014">covars::covarflag</a>, <a class="el" href="covars_8f90_source.html#l00164">covars::covarfunc()</a>, <a class="el" href="choleskymod_8f90_source.html#l00135">choleskymod::invertsymmetric()</a>, <a class="el" href="choleskymod_8f90_source.html#l00272">choleskymod::matrixmulttrans()</a>, <a class="el" href="choleskymod_8f90_source.html#l00234">choleskymod::symmatrixmult()</a>, and <a class="el" href="choleskymod_8f90_source.html#l00309">choleskymod::symmatrixmulttrans()</a>.</p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>
Copyright (C) 2012 Brian A. Lockwood <br>
Generated on Tue May 1 2012 17:15:55 for Kriging Library
by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer"
							 src="doxygen.png"
							 alt="doxygen"/></a>
1.7.3
</small></address>
